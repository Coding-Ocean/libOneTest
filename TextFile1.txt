#ifdef L
#include"framework.h"
#include"graphic.h"
#include"input.h"
#include"mathUtil.h"
#include"VECTOR3.h"
/*
³OŠpŒ`ƒx[ƒX‚Ìcube‚ÉŒ©‚¦‚é‚æ‚¤‚È}Œ`‚ğ•À‚×‚Ä•`‰æ‚·‚é
*/
struct CUBE {
    //cube‚Ì•Ó‚Ì’·‚³
    float len;
    //‚Ğ‚µŒ`‚Ì‘ÎŠpü‚Ì”¼•ª‚Ì’·‚³
    float lx, ly;
    int idx;
    //cube‚Æcube‚ÌŠÔŠu
    float w, h;
    //c‰¡‚É•À‚×‚é”
    int nx, ny;
    //window‚Ì‘å‚«‚³
    float width, height;
};
void initData(struct CUBE* dat) {
    struct CUBE& data = *dat;
    //cube‚Ì•Ó‚Ì’·‚³
    data.len = 100;
    //‚Ğ‚µŒ`‚Ì‘ÎŠpü‚Ì”¼•ª‚Ì’·‚³
    float rad = 3.141592f / 6;
    data.lx = data.len * cos(rad);
    data.ly = data.len * sin(rad);
    //cube‚Æcube‚ÌŠÔŠu
    data.w = data.lx * 2;
    data.h = data.ly * 3;
    //c‰¡‚É•À‚×‚é”
    data.nx = 11;
    data.ny = 7;
    //window‚Ì‘å‚«‚³
    data.width = (data.nx - 1) * data.w + data.lx;
    data.height = (data.ny - 1) * data.h + data.ly;
}
void createDiamondShape(struct CUBE& data) {
    //‚Ğ‚µŒ`‚ğ‚Â‚­‚é
    VECTOR3 vertices[] = {
        VECTOR3(0,0,0),
        VECTOR3(data.lx,-data.ly,0),
        VECTOR3(0,-data.len,0),
        VECTOR3(-data.lx,-data.ly,0),
    };
    WORD indices[] = {
        0,1,2,
        2,3,0
    };
    data.idx = createShape(
        vertices, sizeof(vertices) / sizeof(VECTOR3),
        indices, sizeof(indices) / sizeof(WORD)
    );
}
void drawCube(int idx, float x, float y, int colType) {
    //‚Ğ‚µŒ`‚ğ120“x‚¸‚Â‰ñ“]•`‰æ‚µ‚Äcube‚ÉŒ©‚¹‚é
    float rad = 3.141592f * 2 / 3;
    if (colType == 0)fill(255, 190, 0);
    else fill(0, 120, 0);
    shape(idx, x, y, 0.0f, 1);
    if (colType == 0)fill(0, 190, 0);
    else fill(255, 120, 0);
    shape(idx, x, y, rad * 4, 1);
    if (colType == 0)fill(0, 150, 0);
    else fill(255, 80, 0);
    shape(idx, x, y, -rad * 4, 1);
}
void drawCubes(const struct CUBE& data) {
    strokeWeight(2);
    for (int j = 0; j < data.ny; j++) {
        for (int i = 0; i < data.nx; i++) {
            float x = (j % 2 * data.lx) + data.w * i;
            float y = data.ly + data.h * j;
            int colType = (j / 2 + i) % 2;
            drawCube(data.idx, x, y, colType);
        }
    }
}

int createStarShape() {
    //™
    VECTOR3 vertices[10];
    float r = 3.141592f / 5;
    for (int i = 0; i < 10; i++) {
        float radius = 0.5f + 0.5f * (1 - i % 2);
        vertices[i].x = sin(r * i) * radius;
        vertices[i].y = -cos(r * i) * radius;
    }
    WORD indices[] = {
        0,9,1,
        2,1,3,
        4,3,5,
        6,5,7,
        8,7,9,
        1,9,3,
        9,5,3,
        9,7,5
    };
    return createShape(
        vertices, sizeof(vertices) / sizeof(VECTOR3),
        indices, sizeof(indices) / sizeof(WORD)
    );
}

void gmain() {
    struct CUBE data;
    initData(&data);
    window(data.width, data.height);
    createDiamondShape(data);
    while (notQuit) {
        clear(220, 220, 220);
        drawCubes(data);
    }
}
#endif
